{% extends 'basic.html' %} {% block body %}
<div class="text-white" id="cartapp">
  <h1 class="title text-white">Cart</h1>
  {% if cart %} {% for item in cart %} {% with product=item.product %}
  <p>
    Product: {{product.name}}
    {% comment %} <form @submit="removeProduct({{product.id}})">
    <button type="submit"> Remove</button>
    </form> {% endcomment %}
    <button @click="removeProduct({{product.id}})">Remove</button>
  </p>

  {% endwith %} {% endfor %} {% else %}
  <p>Your cart if empty</p>

  {% endif %}
</div>
{% endblock %} {% block js %}
<script>
  var cartapp = new Vue({
    el: "#cartapp",
    delimeters: ["[[", "]]"],
    data() {
      return {};
    },
    mounted() {
      console.log("mounted");
    },
    methods: {
      removeProduct(prod_id) {

        var data = { product_id: prod_id };

        fetch("/remove_from_cart/", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": "{{ csrf_token }}",
          },
          credentials: "same-origin",
          body: JSON.stringify(data),
        })
        .then((response) => {
            console.log(response);
        })
        .catch(function(error) {
            console.log("error 2");
            console.log(error);
        });
        console.log("Product_ID:", prod_id);

      },
    },
  });
</script>
{% endblock %}
